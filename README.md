## **まじん式プロンプト Chrome拡張機能 ご利用ガイド**

### **はじめに**

このツールは、あなたが入力した文章（議事録、企画書、メモなど）をAIが解析し、デザインが適用されたGoogleスライドを全自動で作成するChrome拡張機能です。

このガイドでは、ツールの利用に必要となる初回の設定手順と、基本的な使い方について解説します。

### **準備するもの**

1.  **このChrome拡張機能**（インストール済み）
2.  **新しく作成した、空のGoogleスライド**
    *  （既存のスライドでも動作しますが、念のため空のスライドで始めることをお勧めします）
3.  **Google AI Studio の「ＡＰＩキー」**
    *  無料で取得可能です。

---


### **1. 初期設定（初回のみ）**

この拡張機能は、セキュリティを確保するため、利用者自身でいくつかの設定を行っていただく必要があります。少し手順が多いですが、最初に一度だけ設定すれば完了です！

#### **【設定の全体像】**
1.  **ソースコードを準備し、Chromeで拡張機能IDを確定させる**
2.  **Google Cloudで、そのID専用の認証キー（クライアントID）を作成する**
3.  **ソースコード内の設定ファイル（`manifest.json`）を自分のキーで書き換える**
4.  **Google Apps Scriptを準備し、AI用のAPIキーを設定する**
5.  **拡張機能の画面で最終設定を行う**

---

#### **ステップ1: ソースコードの準備と拡張機能IDの取得**

1.  まず、このGitHubリポジトリからソースコード一式をダウンロードします。（緑色の`< > Code`ボタン > `Download ZIP`）
2.  ダウンロードしたZIPファイルを解凍します。
3.  Chromeブラウザで、アドレスバーに `chrome://extensions` と入力して拡張機能管理ページを開きます。
4.  右上の **「デベロッパーモード」** のスイッチをオンにします。
5.  左上に表示される **「パッケージ化されていない拡張機能を読み込む」** ボタンをクリックし、先ほど解凍したフォルダを選択します。
6.  「スライド自動生成」が一覧に追加されます。カードに表示されている **`ID:`** の後の長い文字列（例: `abcdefghijklmnopqrstuvwxyz123456`）をコピーし、メモ帳などに控えておきます。これがあなたの拡張機能固有のIDになります。

#### **ステップ2: Google CloudでOAuthクライアントIDを作成する**

1.  [Google Cloudコンソール](https://console.cloud.google.com/)にアクセスし、準備したGoogle Cloudプロジェクトを選択します。（プロジェクトがない場合は新しく作成してください）
2.  左上のナビゲーションメニュー（☰）から `APIとサービス` > `OAuth同意画面` を選択します。
    *   **User Type** は **「外部」** を選択し、「作成」をクリックします。
    *   **アプリ名**（例: スライド自動生成）、**ユーザーサポートメール**、**デベロッパーの連絡先情報** にご自身のメールアドレスを入力し、**「保存して次へ」** をクリックします。（他の項目は空欄で構いません）
    *   スコープ、テストユーザーの画面は何もせず **「保存して次へ」** で進み、「概要」に戻ります。
3.  次に、左側のメニューから `認証情報` を選択します。
4.  画面上部の `＋ 認証情報を作成` > `OAuthクライアントID` を選択します。
5.  **アプリケーションの種類**で **「Chromeアプリ」** を選択します。
6.  **アプリケーションID** の欄に、**ステップ1でコピーしておいたあなたの拡張機能ID**を貼り付けます。
7.  `作成`ボタンをクリックすると、**クライアントID**（`数字-英数字.apps.googleusercontent.com` という形式）が生成されます。これを **`コピー`** ボタンでコピーし、メモ帳などに控えておきます。

#### **ステップ3: `manifest.json`の更新と拡張機能のリロード**

1.  **ステップ1**で解凍したソースコードのフォルダに戻り、`manifest.json` というファイルをテキストエディタで開きます。
2.  ファイルの中にある以下の部分を見つけます。
    ```json
    "client_id": "ご自身のOAuth2.0クライアントIDに変更してください。",
    ```
3.  この `"ご自身のOAuth2.0クライアントIDに変更してください。"` の部分を、**ステップ2でコピーしたあなた自身のクライアントID**に書き換えます。
    ```json
    // 書き換え例
    "client_id": "12855012094-c3jal12g1hd0emb487ggobtakrpsk6a5.apps.googleusercontent.com",
    ```
4.  ファイルを上書き保存します。
5.  Chromeの拡張機能管理ページ（`chrome://extensions`）に戻り、「スライド自動生成」カードの**リロード（更新）ボタン**を押します。

#### **ステップ4: Apps Scriptプロジェクトの作成とスクリプトIDの取得**

1.  準備したGoogleスライドを開き、上部メニューから `拡張機能` > `Apps Script` をクリックします。
2.  「無題のプロジェクト」という名前のApps Scriptエディタが新しいタブで開きます。
3.  このタブのURLの中の `/projects/` と `/edit` の間にある、長い英数字の羅列が**スクリプトID**です。これをコピーします。
    *   **URLの例**: `https://script.google.com/home/projects/`**`1SN...V3-u`**`/edit`

#### **ステップ5: WebアプリとしてデプロイとデプロイIDの取得**

1.  Apps Scriptの画面右上の青い **`[デプロイ]`** ボタン > `[新しいデプロイ]` を選択します。
2.  歯車(⚙️)アイコンをクリックし、`[ウェブアプリ]` を選択します。
3.  以下の通りに設定し、**`[デプロイ]`** ボタンをクリックします。
    *   **次のユーザーとして実行**: `自分（あなたのメールアドレス）`
    *   **アクセスできるユーザー**: `全員`
4.  「デプロイメントが更新されました」と表示されたら、`ウェブアプリ` の下にある**デプロイID**を `[コピー]` ボタンでコピーします。

#### **ステップ6: Google AI Studio でGemini APIキーを取得**
1.  [https://aistudio.google.com/api-keys](https://aistudio.google.com/api-keys) にアクセスし、手順に従って**APIキー**を作成・コピーします。

#### **ステップ7: Apps ScriptにGemini APIキーを設定する**
1.  Apps Scriptの画面に戻り、左側の歯車(⚙️)アイコン（プロジェクトの設定）をクリックします。
2.  一番下までスクロールし、 `スクリプト プロパティを追加` をクリックします。
3.  以下の通りに入力し、`スクリプト プロパティを保存` をクリックします。
    *   **プロパティ**: `GEMINI_API_KEY`
    *   **値**: **ステップ6**でコピーしたAPIキー

#### **ステップ8: 拡張機能パネルでの最終設定**

1.  Chrome拡張機能のアイコンをクリックして、サイドパネルを開きます。
2.  `▼ API・GAS設定 (必須項目)` をクリックして設定欄を開きます。
3.  以下の情報を貼り付けます。
    *   `スクリプトID`: **ステップ4**でコピーしたもの
    *   `デプロイID`: **ステップ5**でコピーしたもの
4.  `AI Model` 欄に、使用したいAIモデル名（例: `gemini-2.5-flash-lite`）を入力します。
5.  最後に、緑色の **`[設定を保存]`** ボタンを必ずクリックします。


## 【重要：プライバシーに関する注意】
### APIキーには、課金設定が有効でないものと有効なものの2種類があり、Googleによるデータの取り扱いが異なります。
#### 課金設定なし（デフォルト）: 入力した内容がGoogleのサービス向上のために利用される可能性があります。 個人的なメモや学習用途に適しています。
#### 課金設定あり（推奨）: 入力した内容がサービス向上のために利用されることはありません。 個人情報、ビジネス文書、機密情報を扱う場合は、Google Cloudプロジェクトで課金設定を有効にしたAPIキーを取得して設定してください。（※少量の利用であれば、無料利用枠の範囲内で費用は発生しません）
#### ご自身の用途に合わせて、適切なAPIキーを設定してください。

これでAIを活用する準備ができました。

以上で初期設定は完了です！

---

### **2. 基本的な使い方**

#### **スライドを新しく生成する**

1.  拡張機能の一番上にある `スライド原稿入力` 欄に、スライドにしたい文章を貼り付けます。
2.  `▼ API・GAS設定` を開き、**プロジェクトが上書きされるリスクを理解した上で、確認ボックスにチェックを入れます。**
3.  青い **`[全自動でスライドを生成]`** ボタンをクリックします。
4.  ボタンのすぐ上にあるグレーのエリアに処理状況が表示されます。「スライドの生成が完了しました」と表示されるまで、しばらくお待ちください（数十秒～数分かかります）。
5.  初回のみ、青い **`[全自動でスライドを生成]`** ボタンの上のグレーの欄に、
    * GASからの応答が予期せぬ形式でした。ページを再読み込みするか、開発者にご連絡ください。と表示されます。 
    * **`Apps Scriptの画面`** に戻り、画面左の **`＜＞`** をクリックしてください。
    * **`実行`** ボタンをクリックすると、承認が必要ですとポップアップが表示されますので、ポップアップ右下の **`権限を確認`** をクリックします。
    * アカウントを選択してください。の画面で右側のメールアドレスをクリックします。
    * **`このアプリは Google で確認されていません`** と表示されるので、左下の **`詳細`** をクリックし、左下の **`無題のプロジェクト（安全ではないページ）に移動`** をクリックしてください。
    * **`無題のプロジェクト にログイン`** 画面が表示されるので、右下の **`次へ`** をクリックしてください。
    * **`無題のプロジェクト が Google アカウントへのアクセスを求めています`** の画面が表示されるので、 下へスクロールし、 **`無題のプロジェクト がアクセスできる情報を選択してください`** の下の **`□すべて選択`** のチェックボックスにチェックを入れます。
    * 一番下までスクロールして、 **`続行`** をクリックします。
6.  上記5.を実施した場合は、再度3.の青い **`[全自動でスライドを生成]`** ボタンをクリックします。
7.  ボタンのすぐ上にあるグレーのエリアに処理状況が表示されます。「スライドの生成が完了しました」と表示されるまで、しばらくお待ちください（数十秒～数分かかります）。

#### **デザインだけを変更して作り直す**

一度スライドを生成した後、ロゴや色などのデザインだけを変更したい場合は、AIに再度問い合わせる必要はありません。

1.  `▼ ロゴ・フッターテキスト設定` や `▼ フォント・カラー設定` などを開き、お好みのデザインに変更します。
2.  緑色の **`[設定を保存]`** ボタンをクリックします。
3.  緑色の **`[デザインを反映して再生成]`** ボタンをクリックします。AIを使わないため、高速で処理が完了します。

---

### **3. 各種設定と機能の詳細**

#### **設定項目について**

*   **ロゴ・フッターテキスト設定**: スライドに表示される会社名やロゴ画像（URL形式）を設定できます。
*   **背景画像設定**: スライドの背景を、グラデーションの代わりに指定した画像（URL形式）に変更できます。
*   **フォント・カラー設定**: スライド全体のフォントの種類、文字色、テーマカラー（下線など）、背景のグラデーションなどを自由にカスタマイズできます。

#### **ボタンについて**

*   **`[設定を保存]`**: 拡張機能で行ったすべての設定変更を、お使いのブラウザに保存します。**変更後は必ずクリックしてください。**
*   **`[設定を初期化]`**: すべての設定をインストール直後の初期状態に戻します。
*   **`[GAS認証をリセット]`**: Googleアカウントとの連携でエラーが続く場合に試してみてください。認証情報（トークン）をリセットし、次回の実行時に再認証を促します。