## **まじん式プロンプト Chrome拡張機能 ご利用ガイド**

### **はじめに**

このツールは、あなたが入力した文章（議事録、企画書、メモなど）をAIが解析し、デザインが適用されたGoogleスライドを全自動で作成するChrome拡張機能です。

このガイドでは、ツールの利用に必要となる初回の設定手順と、基本的な使い方について解説します。

### **準備するもの**

1.  **このChrome拡張機能**（インストール済み）
2.  **新しく作成した、空のGoogleスライド**
    *  （既存のスライドでも動作しますが、念のため空のスライドで始めることをお勧めします）
3.  **Google AI Studio の「ＡＰＩキー」**
    *  無料で取得可能です。

---

### **1. 初期設定（初回のみ）**

少し手順が多いですが、最初に一度だけ設定すれば完了です！

#### **ステップ1: Apps Scriptプロジェクトの作成とスクリプトIDの取得**

1.  準備したGoogleスライドを開き、上部メニューから `拡張機能` > `Apps Script` をクリックします。
2.  「無題のプロジェクト」という名前のApps Scriptエディタが新しいタブで開きます。
3.  このタブのURLに注目してください。URLの中の `/projects/` と `/edit` の間にある、長い英数字の羅列が**スクリプトID**です。

    *   **URLの例**: `https://script.google.com/home/projects/`**`1SN...V3-u`**`/edit`
    *   この例では、太字の部分 `1SN...V3-u` がスクリプトIDになります。これをコピーしてください。

#### **ステップ2: 拡張機能へのスクリプトID設定**

1.  Chrome拡張機能のアイコンをクリックして、サイドパネルを開きます。
2.  `▼ API・GAS設定 (必須項目)` をクリックして、設定欄を開きます。
3.  `スクリプトID` の欄に、先ほどコピーした**スクリプトID**を貼り付けます。
4.  緑色の **`[設定を保存]`** ボタンを必ずクリックしてください。

#### **ステップ3: WebアプリとしてデプロイとデプロイIDの取得**

1.  先ほどのApps Scriptの画面に戻ります。
2.  画面右上の青い **`[デプロイ]`** ボタンをクリックし、`[新しいデプロイ]` を選択します。
3.  「種類の選択」の左にある**歯車(⚙️)アイコン**をクリックし、`[ウェブアプリ]` を選択します。
4.  以下の通りに設定してください。
    *   **次のユーザーとして実行**: `自分（あなたのメールアドレス）`
    *   **アクセスできるユーザー**: `全員`
5.  右下の **`[デプロイ]`** ボタンをクリックします。

    *   **【権限の承認】**
    *   もし「アクセスを承認」という画面が表示されたら、以下の手順で承認してください。これは、あなたのアカウントでスライドを操作する許可をスクリプトに与えるための正常な手続きです。
        1.  `[アクセスを承認]` ボタンをクリックします。
        2.  ご自身のGoogleアカウントを選択します。
        3.  「Google hasn’t verified this app」という警告が出ますが、問題ありません。左下の `[Advanced]` をクリックします。
        4.  `[Go to 無題のプロジェクト (unsafe)]` をクリックします。
        5.  次の画面で右下の `[Allow]` をクリックします。

6.  「デプロイメントが更新されました」と表示されたら、`ウェブアプリ` の下にある**デプロイID**を `[コピー]` ボタンでコピーします。

#### **ステップ4: 拡張機能へのデプロイID設定**

1.  再びChrome拡張機能のパネルに戻ります。
2.  `▼ API・GAS設定 (必須項目)` 内の `デプロイID` 欄に、先ほどコピーした**デプロイID**を貼り付けます。
3.  `AI Model` 欄に、使用したいAIモデル名を入力します。お好みのものを一つ選んで入力してください。
    *   `gemini-2.5-flash-lite`（**推奨**: 高速で十分な性能）
    *   `gemini-2.5-flash`（高速で十分な性能）
    *   `gemini-2.5-pro`（より高精度ですが、処理に時間がかかる場合があります）
4.  最後に、もう一度緑色の **`[設定を保存]`** ボタンをクリックします。

#### **ステップ5: Google AI Studio でＡＰＩキーを取得**
1.  https://aistudio.google.com/api-keys　にアクセスします。
2.  右上の **`APIキーを作成`** ボタンをクリックします。
3.  画面中央に表示される、 **`No Cloud Project Available`** をクリックします。
4.  続けて **`Create project`** をクリックします
5.  プロジェクトに名前を付けるの下の欄に、majinなどと入力し、右下の **`プロジェクトを作成`** をクリックします。
6.  同じ画面のCreate projectの下に入力したmajinなどの文字が表示されるので、それをクリックします。
7.  **`キーを作成`** をクリックします。
8.  お支払い情報を設定の右に **`コピーボタン`** が有るのでそれをクリックして、APIキーをコピーし、メモ帳などに貼り付けます。

#### **ステップ6: Apps Scriptの画面にAPIキーを設定する**
1.  先ほどのApps Scriptの画面に戻ります。
2.  画面左の中央あたりの **`歯車(⚙️)アイコン（プロジェクトの設定）`** をクリックします。
3.  一番下までスクロールし、 **`スクリプト プロパティを追加`** をクリックします。
4.  左側のプロパティに **`GEMINI_API_KEY`** と入力します。
5.  右側の値に **`ステップ5`** でコピーしたAPIキーを貼り付けます。Alzから始まる長いキーが貼りつきます。
6.  その下の **`スクリプト プロパティを保存`** をクリックします。

これでAIを活用する準備ができました。

以上で初期設定は完了です！

---

### **2. 基本的な使い方**

#### **スライドを新しく生成する**

1.  拡張機能の一番上にある `スライド原稿入力` 欄に、スライドにしたい文章を貼り付けます。
2.  `▼ API・GAS設定` を開き、**プロジェクトが上書きされるリスクを理解した上で、確認ボックスにチェックを入れます。**
3.  青い **`[全自動でスライドを生成]`** ボタンをクリックします。
4.  ボタンのすぐ上にあるグレーのエリアに処理状況が表示されます。「スライドの生成が完了しました」と表示されるまで、しばらくお待ちください（数十秒～数分かかります）。
5.  初回のみ、青い **`[全自動でスライドを生成]`** ボタンの上のグレーの欄に、
    * GASからの応答が予期せぬ形式でした。ページを再読み込みするか、開発者にご連絡ください。と表示されます。 **`Apps Scriptの画面`** に戻り、画面左の **`＜＞`** をクリックしてください。
    **`実行`** ボタンをクリックすると、承認が必要ですとポップアップが表示されますので、ポップアップ右下の **`権限を確認`** をクリックします。
    アカウントを選択してください。の画面で右側のメールアドレスをクリックします。
    **`このアプリは Google で確認されていません`** と表示されるので、左下の **`詳細`**をクリックし、
    左下の **`無題のプロジェクト（安全ではないページ）に移動`** をクリックしてください。
    **`無題のプロジェクト にログイン`** 画面が表示されるので、右下の **`次へ`**をクリックしてください。
    **`無題のプロジェクト が Google アカウントへのアクセスを求めています`**の画面が表示されるので、 下へスクロールし、 **`無題のプロジェクト がアクセスできる情報を選択してください`**　の下の
    **`□すべて選択`**のチェックボックスにチェックを入れます。
    一番下までスクロールして、**`続行`**をクリックします。
6.  上記5.を実施した場合は、再度3.の青い **`[全自動でスライドを生成]`** ボタンをクリックします。
7.  






#### **デザインだけを変更して作り直す**

一度スライドを生成した後、ロゴや色などのデザインだけを変更したい場合は、AIに再度問い合わせる必要はありません。

1.  `▼ ロゴ・フッターテキスト設定` や `▼ フォント・カラー設定` などを開き、お好みのデザインに変更します。
2.  緑色の **`[設定を保存]`** ボタンをクリックします。
3.  緑色の **`[デザインを反映して再生成]`** ボタンをクリックします。AIを使わないため、高速で処理が完了します。

---

### **3. 各種設定と機能の詳細**

#### **設定項目について**

*   **ロゴ・フッターテキスト設定**: スライドに表示される会社名やロゴ画像（URL形式）を設定できます。
*   **背景画像設定**: スライドの背景を、グラデーションの代わりに指定した画像（URL形式）に変更できます。
*   **フォント・カラー設定**: スライド全体のフォントの種類、文字色、テーマカラー（下線など）、背景のグラデーションなどを自由にカスタマイズできます。

#### **ボタンについて**

*   **`[設定を保存]`**: 拡張機能で行ったすべての設定変更を、お使いのブラウザに保存します。**変更後は必ずクリックしてください。**
*   **`[設定を初期化]`**: すべての設定をインストール直後の初期状態に戻します。
*   **`[GAS認証をリセット]`**: Googleアカウントとの連携でエラーが続く場合に試してみてください。認証情報（トークン）をリセットし、次回の実行時に再認証を促します。