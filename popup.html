<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <style>
    body { width: 320px; padding: 5px; font-family: sans-serif; box-sizing: border-box; }
    h3 { text-align: center; margin-bottom: 10px; }
    h4 { text-align: left; font-weight: normal; color: #555; margin-top: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px;}
    
    textarea, .settings-item input select{
      width: 100%; padding: 8px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; margin-bottom: 10px;
    }
    textarea { height: 150px; resize: vertical; }

    button { padding: 12px; font-size: 16px; cursor: pointer; border: none; border-radius: 4px; }
    button:disabled { cursor: not-allowed; }
    
    #generate-button { width: 100%; background-color: #4285F4; color: white; margin-bottom: 15px; }
    #generate-button:disabled { background-color: #a0c3ff; }
    
    .settings-group1 { margin-top: 1px; background-color: #f0ffff; padding: 0px; border-radius: 10px; }
    .settings-group2 { margin-top: 1px; background-color: #e0ffff; padding: 0px; border-radius: 10px; }
    .settings-group3 { margin-top: 1px; background-color: #d0ffff; padding: 0px; border-radius: 10px; }
    .settings-group4 { margin-top: 1px; background-color: #c0ffff; padding: 0px; border-radius: 10px; }
    .settings-group5 { margin-top: 1px; background-color: #ffe875; padding: 0px; border-radius: 10px; }

    .collapsible1, 
    .collapsible2, 
    .collapsible3, 
    .collapsible4, 
    .collapsible5 {
       cursor: pointer; user-select: none; font-weight: bold; text-align: left; }
    
    .collapsible1-content, 
    .collapsible2-content, 
    .collapsible3-content, 
    .collapsible4-content,
    .collapsible5-content { 
      padding-top: 10px; display: none; overflow: hidden; }

    .settings-item { display: flex; align-items: center; margin-bottom: 12px; }
    .settings-item label { flex: 0 0 160px; font-size: 14px; color: #333; padding-right: 10px; }
    .settings-item input { flex: 1; margin-bottom: 0; }
    
    .regenerate-section { padding-top: 10px; border-top: 1px solid #ccc; }
    .settings { display: flex; align-items: center; margin-bottom: 10px; }
    .settings label { flex: 1; }
    
    #regenerate-button { width: 100%; background-color: #34A853; color: white; }
    #regenerate-button:disabled { background-color: #a7d7b4; }
    
    .action-buttons { display: flex; gap: 10px; margin-bottom: 5px; align-items: center; }
    .action-buttons button { width: 150px; font-size: 14px; padding: 8px; }
    #save-settings-button { background-color: #0F9D58; color: white; }
    #reset-settings-button { background-color: #6c757d; color: white; }
    #feedback-message { flex: 1; font-size: 14px; color: #0F9D58; padding-left: 10px; }


    #status-message { 
      margin-top: 15px; 
      font-size: 14px; 
      min-height: 20px; 
      text-align: left; 
      color: #333; 
      padding: 8px; 
      border-radius: 4px; 
      background-color: #e8f0fe; }

    .vertical-item { flex-direction: column; align-items: flex-start; }
    .vertical-item label { margin-top: 1px; margin-bottom: 1px; padding-right: 0; flex: none; }
    
    .radio-group { display: flex; align-items: center; gap: 10px; }
    .radio-group label { font-size: 13px; cursor: pointer; }
    .radio-group input { margin: 0; width: auto; cursor: pointer; }

    .settings-group-vertical { margin-bottom: 10px; }
    .settings-group-vertical > label { display: block; margin-bottom: 8px; font-size: 14px; color: #333; }
  </style>
</head>
<body>
  <h3>スライド原稿入力</h3>
  <textarea id="user-prompt" placeholder="ここにスライドにしたい内容を貼り付け..."></textarea>
  
  <div class="settings-group1">
    <h4 class="collapsible1">▼ API・GAS設定 (必須項目)</h4>
    <div class="collapsible1-content">
      <div style="background-color: #fff8e1; border: 1px solid #ffecb3; border-radius: 4px; padding: 8px; margin-bottom: 10px; font-size: 12px; color: #616161;">
        <strong>【重要】</strong> ここには、この拡張機能専用の<b>空のGoogle Apps Scriptプロジェクト</b>のIDを指定してください。既存のスクリプトが入っているIDを指定すると、<b>警告なしに内容がすべて上書きされ、復元できません。</b>
      </div>
      <div class="settings-item" style="margin-top: 15px; align-items: flex-start;">
        <input type="checkbox" id="overwrite-confirm" style="width: auto; margin-right: 8px; margin-top: 2px; flex-shrink: 0;">
        <span id="overwrite-confirm-label" style="background-color: #fff8e1; font-size: 12px; color: #333; user-select: none; line-height: 1.4;">上記のリスクを理解し、プロジェクトの上書きを許可します。</span>
      </div>

      <div class="settings-item vertical-item">
        <label for="script-id">スクリプト ID</label>
        <input type="text" id="script-id">
      </div>
      <div class="settings-item vertical-item">
        <label for="deployment-id">デプロイ ID</label>
        <input type="text" id="deployment-id">
      </div>
      <div class="settings-item vertical-item">
        <label for="ai-model">AI Model</label>
        <input type="text" id="ai-model">
      </div>
    </div>
  </div>

  <div class="settings-group2">
    <h4 class="collapsible2">▼ ロゴ・フッターテキスト設定</h4>
    <div class="collapsible2-content">
      <div class="settings-item vertical-item">
        <label for="footer-text">フッターテキスト</label>
        <input type="text" id="footer-text" placeholder="読み込み中...">
      </div>
      <div class="settings-item vertical-item">
        <label for="header-logo">ヘッダーロゴURL</label>
        <input type="text" id="header-logo" placeholder="読み込み中...">
      </div>
      <div class="settings-item vertical-item">
        <label for="closing-logo">クロージングロゴURL</label>
        <input type="text" id="closing-logo" placeholder="読み込み中...">
      </div>
    </div>
  </div>

  <div class="settings-group3">
    <h4 class="collapsible3">▼ 背景画像設定</h4>
    <div class="collapsible3-content">
      <div class="settings-item vertical-item">
        <label for="title-head">Canvaなどで作成した画像のURLや、以下のギャラりーからURLをコピーしてください。</label>
        <b><a href="https://sinzy0925.github.io/logo/" target="_blank">ギャラリー</a></b>
      </div>
      <div class="settings-item vertical-item">
        <label for="title-bg">タイトル頁 背景画像URL</label>
        <input type="text" id="title-bg">
      </div>
      <div class="settings-item vertical-item">
        <label for="content-bg">本文 背景画像URL</label>
        <input type="text" id="content-bg">
      </div>
      <div class="settings-item vertical-item">
        <label for="closing-bg">最終頁 背景画像URL</label>
        <input type="text" id="closing-bg">
      </div>
    </div>
  </div>


  <div class="settings-group4">
    <h4 class="collapsible4">▼ フォント・カラー設定</h4>
    <div class="collapsible4-content">

      <div class="settings">
        <label for="font-family">フォント:</label>
        <select id="font-family">
          <option value="Arial">Arial (システムフォント)</option>
          <option value="Noto Sans JP">Noto Sans JP (ゴシック体)</option>
          <option value="M PLUS 1p">M PLUS 1p (ゴシック体)</option>
          <option value="Noto Serif JP">Noto Serif JP (明朝体)</option>
          <option value="Kosugi Maru">Kosugi Maru (丸ゴシック)</option>
          <option value="Roboto">Roboto (欧文向け)</option>
        </select>
      </div>
      <div class="settings">
        <label for="original-font-family">オリジナルフォント (優先):</label> <!-- for属性とラベル名を変更 -->
        <input type="text" id="original-font-family" placeholder="例: Meiryo"> <!-- 新しいidを割り当て -->
      </div>

      <div class="settings">
        <label for="font-color">フォントカラー:</label>
        <input type="color" id="font-color" value="#4285F4">
      </div>
      <div class="settings">
        <label for="primary-color">ラインカラー:</label>
        <input type="color" id="primary-color" value="#4285F4">
      </div>

      <div class="settings">
        <label for="bg-gradient-start-color">背景グラデーション[start]:</label>
        <input type="color" id="bg-gradient-start-color" value="#FFFFFF">
      </div>
      <div class="settings">
        <label for="bg-gradient-end-color">背景グラデーション[End]:</label>
        <input type="color" id="bg-gradient-end-color" value="#00FFFF">
      </div>
      
      <div class="settings-group-vertical">
        <label>グラデーションの向き:</label>
        <div class="radio-group">
          <input type="radio" id="dir-vertical" name="gradient-direction" value="vertical" checked>
          <label for="dir-vertical">上→下</label>
          <input type="radio" id="dir-diag-lr" name="gradient-direction" value="diagonal-lr">
          <label for="dir-diag-lr">左上→右下</label>
          <input type="radio" id="dir-diag-rl" name="gradient-direction" value="diagonal-rl">
          <label for="dir-diag-rl">右上→左下</label>
        </div>
      </div>
    </div>
  </div>

  <div class="settings-group5">
    <h4 class="collapsible5">▼ GAS認証をリセット（トークン初期化）</h4>
    <div class="collapsible5-content">

      <div style="margin-top: 15px; border-top: 1px solid #eee; padding-top: 10px;">
        <button id="revoke-token-button" style="width:100%; background-color: #db4437; color: white; font-size: 13px; padding: 8px;">GAS認証をリセット（トークン初期化）</button>
        <p style="font-size: 11px; color: #666; margin-top: 5px;">認証エラーが続く場合や、アカウントを切り替えたい場合にお試しください。</p>
      </div>

    </div>
  </div>


  <div class="action-buttons">
    <button id="save-settings-button">設定を保存</button>
    <button id="reset-settings-button">設定を初期化</button>
    <span id="feedback-message"></span>
  </div>

  <p id="status-message"></p>
  <button id="generate-button">全自動でスライドを生成</button>

  <div class="regenerate-section">
    <button id="regenerate-button">デザインを反映して再生成</button>
  </div>
  
  <script src="popup.js"></script>
</body>
</html>